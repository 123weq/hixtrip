# hixtrip

## 需求

实现一个标准电商平台的一个下单功能

1. 完整实现一个下单功能，包含以下功能：查询SKU价格(模拟，不需要实现)，扣减库存(只在缓存实现)，支付(模拟,不需要实现,但要处理结果回调), 生成订单
2. 围绕下单功能，设计订单相关业务库表结构，并生成mybatis代码, 库存、商品等无需建表。

## 技术要求
基础设施层限制使用mybatis\spring data redis实现（不考虑事务及分布式事务）。

### 初级
1. 【10分】基于基础代码实现，要求理解DDD思想, 按示例要求(注意看代码注释和TODO)分层实现下单业务。 \
          领域服务已定义, 不允许新增领域层接口, 请注意看代码注释, 并在APP层进行调用。 \
2. 【20分】支付回调只处理支付成功场景
3. 【30分】resources/sql中给出订单表建表语句。 (库存、商品等无需建表)
   【40分】库存扣减只在缓存实现

### 中级
1. 【10分】基于基础代码实现，要求理解DDD思想, 按示例要求(注意看代码注释和TODO)分层实现下单业务。 \
          领域服务已定义, 不允许新增领域层接口, 请注意看代码注释, 并在APP层进行调用。 \
2. 【20分】支付回调使用策略模式(支付成功、支付失败、重复支付), 实现越优雅越好。
3. 【30分】resources/sql中给出订单相关表建表语句。 (库存、商品等无需建表) \
          背景: 近期订单量级2000W, 不考虑增长。 \
          场景如下:  \
          1. 买家频繁查询我的订单, 高峰期并发100左右。 \
          2. 卖家频繁查询我的订单, 高峰期并发100左右。 \
          设计包含mysql分库分表技术, 建表语句文件内使用注释方式描述设计方案 \
          如：索引、分库键、分表键的设计思路及具体结论、同时满足买卖双方需求方案等。
4. 【40分】库存扣减只在缓存实现, 需要考虑并发，避免超卖。

### 高级
1. 【10分】基于基础代码实现，要求理解DDD思想, 按示例要求(注意看代码注释和TODO)分层实现下单业务。 领域服务已定义, 不允许新增领域层接口, 请注意看代码注释, 并在APP层进行调用。 业务逻辑使用充血模型
2. 【20分】支付回调使用策略模式(支付成功、支付失败、重复支付)
3. 【10分】基础设施层限制使用mybatis\spring data redis实现（不考虑事务及分布式事务）。
4. 【20分】resources/sql中给出订单相关表建表语句。 (库存、商品等无需建表)
   需要包含分库分表设计，在注释中给出索引、分库键、分表键的设计思路(需要同时满足买家及卖家的高频订单列表查询[我的订单])，
   其它特殊数据处理(如历史订单删除等)，说明思路即可，考虑越全越优。
   【40分】库存扣减需要考虑并发，避免超卖。（按100并发进行设计实现, 只须实现缓存层）
